
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #$Author: sinnwell $
> 
> ## package: haplo.stats
> ## test script: haplo.cc
> 
> ## settings
> verbose=TRUE
> options(width=140)
> require(haplo.stats)
Loading required package: haplo.stats
Loading required package: arsenal
> tmp <- Sys.setlocale("LC_ALL", "C")
> tmp <- Sys.getlocale()
> 
> data(hla.demo)
> 
> # Jason Sinnwell, created 3/2004, updated 9/2014
> # Mayo Clinic, Biostatistics
> 
>   if(verbose) cat("setting up data...\n")
setting up data...
>   
>   label <- c("DQB","DRB","B")
> 
>   y.bin <- 1*(hla.demo$resp.cat=="low")
> 
>   geno <- as.matrix(hla.demo[,c(17,18,21:24)])
> 
>   # commented code was to check data that goes into haplo.cc
>   # and gets pasted together in the huge data.frame.
>   
>  # sink(file="results.haplo.cc.txt")  
> 
>   seed <- c(17, 53, 1, 40, 37, 0, 62, 56, 5, 52, 12, 1)
>  
>   if(verbose) cat("hla data \n")
hla data 
>   set.seed(seed)
>   cc.hla <- haplo.cc(y.bin, geno, miss.val=0,locus.label=label, 
+            control=haplo.glm.control(haplo.min.count=8,  em.c=haplo.em.control()))
>   set.seed(seed)
>   cc.hla.adj <-  haplo.cc(y.bin, geno, x.adj=hla.demo[,c("male","age")], miss.val=0,locus.label=label, 
+            control=haplo.glm.control(haplo.min.count=8,  em.c=haplo.em.control()))
> 
> set.seed(seed)
> ntest <- 200
> geno.test <- cbind(sample(1:2, size=ntest, replace=TRUE), sample(1:2, size=100, replace=TRUE),
+            sample(2:3,size=ntest, replace=TRUE), sample(2:3, size=100, replace=TRUE),
+            sample(2:4,size=ntest, replace=TRUE, prob=c(.5,.35,.15)), sample(2:4, size=100,
+                                             replace=TRUE, prob=c(.5,.35,.15)))
> y.test <- sample(1:2,size=ntest, replace=TRUE,prob=c(.6, .4)) - 1
> x.test <- cbind(rbinom(nrow(geno.test), 1, prob=.3), round(rnorm(nrow(geno.test), mean=50, sd=4)))
> locus.label <- c("A", "B", "C")
> 
> 
> if(verbose) cat("small numeric data... \n")
small numeric data... 
> set.seed(seed)
> cc.test <- haplo.cc(y.test, geno.test, locus.label=locus.label,
+                   ci.prob=.95, control=haplo.glm.control(haplo.min.count=4))
> set.seed(seed)
> cc.adj <- haplo.cc(y.test, geno.test, x.adj=x.test,locus.label=locus.label,
+                   ci.prob=.95, control=haplo.glm.control(haplo.min.count=4))
There were 50 or more warnings (use warnings() to see the first 50)
> 
> 
>   locus.label <- c("A", "B", "C")
> 
>   geno.char <- ifelse(geno.test==1, 'A',ifelse(geno.test==2, 'T',
+                         ifelse(geno.test==3, 'G', 'C')))
> 
>   set.seed(seed)
>   if(verbose) cat("small char data with simulations... \n")
small char data with simulations... 
>   cc.char.sim <- haplo.cc(y.test, geno.char, locus.label=locus.label, 
+                           ci.prob=.90, simulate=FALSE,
+                           control = haplo.glm.control(haplo.min.count=4))
>   
>   print.haplo.cc(cc.hla, digits=3, order.by="score", nlines=12)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 27.3, df = 7, p-val = 0.000296

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    157      63 


    DQB DRB  B Hap-Score    p-val pool.hf control.hf case.hf glm.eff OR.lower     OR OR.upper
188  62   2  7   -2.1846 0.028917 0.05074    0.06815 0.01587     Eff   0.0141 0.0736    0.385
126  51   1 35   -1.5842 0.113142 0.03018    0.03755 0.00893     Eff   0.0104 0.0915    0.805
98   32   4 62   -0.6799 0.496581 0.02349    0.02548      NA     Eff   0.0489 0.2584    1.367
97   32   4 60    0.0306 0.975590 0.03062    0.03159 0.03968     Eff   0.0821 0.3397    1.406
18   21   7 44    1.0559 0.291023 0.02170    0.01741 0.04762     Eff   0.1290 0.6270    3.047
62   31   4 44    2.5165 0.011854 0.02849    0.01473 0.06349     Eff   0.3629 1.3921    5.340
12   21   3  8    3.7769 0.000159 0.10407    0.06973 0.19048    Base       NA 1.0000       NA
1    21   1  8        NA       NA 0.00232    0.00335      NA       R   0.1473 0.2942    0.587
2    21  10  8        NA       NA 0.00181    0.00318      NA       R   0.1473 0.2942    0.587
3    21  13  8        NA       NA 0.00274         NA      NA       R   0.1473 0.2942    0.587
4    21   2 18        NA       NA 0.00227    0.00318      NA       R   0.1473 0.2942    0.587
5    21   2  7        NA       NA 0.00227    0.00318      NA       R   0.1473 0.2942    0.587
>   print(cc.hla.adj, order.by="score",digits=3, nlines=12)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 28.5, df = 7, p-val = 0.00018

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    157      63 


    DQB DRB  B Hap-Score   p-val pool.hf control.hf case.hf glm.eff OR.lower     OR OR.upper
188  62   2  7    -2.258 0.02396 0.05074    0.06815 0.01587     Eff  0.01268 0.0671    0.355
126  51   1 35    -1.648 0.09940 0.03018    0.03755 0.00893     Eff  0.00841 0.0769    0.702
98   32   4 62    -0.731 0.46465 0.02349    0.02548      NA     Eff  0.04535 0.2419    1.290
97   32   4 60     0.205 0.83786 0.03062    0.03159 0.03968     Eff  0.09479 0.4087    1.762
18   21   7 44     0.980 0.32723 0.02170    0.01741 0.04762     Eff  0.11474 0.5579    2.713
62   31   4 44     2.616 0.00890 0.02849    0.01473 0.06349     Eff  0.38914 1.4962    5.753
12   21   3  8     3.774 0.00016 0.10407    0.06973 0.19048    Base       NA 1.0000       NA
1    21   1  8        NA      NA 0.00232    0.00335      NA       R  0.14466 0.2895    0.579
2    21  10  8        NA      NA 0.00181    0.00318      NA       R  0.14466 0.2895    0.579
3    21  13  8        NA      NA 0.00274         NA      NA       R  0.14466 0.2895    0.579
4    21   2 18        NA      NA 0.00227    0.00318      NA       R  0.14466 0.2895    0.579
5    21   2  7        NA      NA 0.00227    0.00318      NA       R  0.14466 0.2895    0.579
> #  print(cc.hla$fit.lst, digits=3)
> #  print(cc.hla$score.lst, digits=3)
>   print.haplo.cc(cc.test, order.by='score', digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.6, df = 11, p-val = 0.749

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
11 2 3 3  -1.29121 0.197 0.08726   1.06e-01  0.0523     Eff 6.12e-02 2.84e-01 1.32e+00
9  2 2 4  -0.95385 0.340 0.02686   3.36e-02  0.0061     Eff 9.18e-04 1.96e-01 4.17e+01
3  1 2 4  -0.68767 0.492 0.04029   4.72e-02  0.0318     Eff 3.66e-02 4.75e-01 6.18e+00
2  1 2 3  -0.66560 0.506 0.05785   6.68e-02  0.0455     Eff 7.93e-02 3.53e-01 1.57e+00
5  1 3 3  -0.47955 0.632 0.08029   8.11e-02  0.0763     Eff 2.76e-01 7.88e-01 2.25e+00
8  2 2 3  -0.12759 0.898 0.09459   8.92e-02  0.1088     Eff 3.34e-01 9.07e-01 2.46e+00
7  2 2 2   0.00552 0.996 0.13883   1.46e-01  0.1379     Eff 1.67e-01 5.76e-01 1.99e+00
4  1 3 2   0.39998 0.689 0.12842   1.31e-01  0.1286     Eff 1.98e-01 6.12e-01 1.89e+00
6  1 3 4   0.63249 0.527 0.05407   4.82e-02  0.0676     Eff 2.69e-01 1.07e+00 4.29e+00
10 2 3 2   0.87404 0.382 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
1  1 2 2   0.88736 0.375 0.12408   1.05e-01  0.1437     Eff 4.16e-01 1.14e+00 3.15e+00
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R 1.50e+11 1.50e+11 1.50e+11
>   print.haplo.cc(cc.test, order.by='haplotype', digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.6, df = 11, p-val = 0.749

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
1  1 2 2   0.88736 0.375 0.12408   1.05e-01  0.1437     Eff 4.16e-01 1.14e+00 3.15e+00
2  1 2 3  -0.66560 0.506 0.05785   6.68e-02  0.0455     Eff 7.93e-02 3.53e-01 1.57e+00
3  1 2 4  -0.68767 0.492 0.04029   4.72e-02  0.0318     Eff 3.66e-02 4.75e-01 6.18e+00
4  1 3 2   0.39998 0.689 0.12842   1.31e-01  0.1286     Eff 1.98e-01 6.12e-01 1.89e+00
5  1 3 3  -0.47955 0.632 0.08029   8.11e-02  0.0763     Eff 2.76e-01 7.88e-01 2.25e+00
6  1 3 4   0.63249 0.527 0.05407   4.82e-02  0.0676     Eff 2.69e-01 1.07e+00 4.29e+00
7  2 2 2   0.00552 0.996 0.13883   1.46e-01  0.1379     Eff 1.67e-01 5.76e-01 1.99e+00
8  2 2 3  -0.12759 0.898 0.09459   8.92e-02  0.1088     Eff 3.34e-01 9.07e-01 2.46e+00
9  2 2 4  -0.95385 0.340 0.02686   3.36e-02  0.0061     Eff 9.18e-04 1.96e-01 4.17e+01
10 2 3 2   0.87404 0.382 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
11 2 3 3  -1.29121 0.197 0.08726   1.06e-01  0.0523     Eff 6.12e-02 2.84e-01 1.32e+00
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R 1.50e+11 1.50e+11 1.50e+11
>   print.haplo.cc(cc.test, order.by='freq', digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.6, df = 11, p-val = 0.749

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
10 2 3 2   0.87404 0.382 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
7  2 2 2   0.00552 0.996 0.13883   1.46e-01  0.1379     Eff 1.67e-01 5.76e-01 1.99e+00
4  1 3 2   0.39998 0.689 0.12842   1.31e-01  0.1286     Eff 1.98e-01 6.12e-01 1.89e+00
1  1 2 2   0.88736 0.375 0.12408   1.05e-01  0.1437     Eff 4.16e-01 1.14e+00 3.15e+00
8  2 2 3  -0.12759 0.898 0.09459   8.92e-02  0.1088     Eff 3.34e-01 9.07e-01 2.46e+00
11 2 3 3  -1.29121 0.197 0.08726   1.06e-01  0.0523     Eff 6.12e-02 2.84e-01 1.32e+00
5  1 3 3  -0.47955 0.632 0.08029   8.11e-02  0.0763     Eff 2.76e-01 7.88e-01 2.25e+00
2  1 2 3  -0.66560 0.506 0.05785   6.68e-02  0.0455     Eff 7.93e-02 3.53e-01 1.57e+00
6  1 3 4   0.63249 0.527 0.05407   4.82e-02  0.0676     Eff 2.69e-01 1.07e+00 4.29e+00
3  1 2 4  -0.68767 0.492 0.04029   4.72e-02  0.0318     Eff 3.66e-02 4.75e-01 6.18e+00
9  2 2 4  -0.95385 0.340 0.02686   3.36e-02  0.0061     Eff 9.18e-04 1.96e-01 4.17e+01
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R 1.50e+11 1.50e+11 1.50e+11
> 
>   print(cc.adj, order.by="score", digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.74, df = 11, p-val = 0.736

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
11 2 3 3   -1.3991 0.162 0.08726   1.06e-01  0.0523     Eff 6.92e-02 3.07e-01 1.36e+00
9  2 2 4   -0.8626 0.388 0.02686   3.36e-02  0.0061     Eff 1.04e-06 1.04e-06 1.04e-06
2  1 2 3   -0.6825 0.495 0.05785   6.68e-02  0.0455     Eff 8.55e-02 3.84e-01 1.72e+00
3  1 2 4   -0.6102 0.542 0.04029   4.72e-02  0.0318     Eff 1.66e-01 7.62e-01 3.50e+00
5  1 3 3   -0.5312 0.595 0.08029   8.11e-02  0.0763     Eff 2.77e-01 7.95e-01 2.28e+00
8  2 2 3   -0.1748 0.861 0.09459   8.92e-02  0.1088     Eff 3.59e-01 9.63e-01 2.58e+00
7  2 2 2    0.0344 0.973 0.13883   1.46e-01  0.1379     Eff 2.04e-01 6.56e-01 2.11e+00
4  1 3 2    0.4168 0.677 0.12842   1.31e-01  0.1286     Eff 2.19e-01 6.65e-01 2.01e+00
6  1 3 4    0.7471 0.455 0.05407   4.82e-02  0.0676     Eff 2.72e-01 1.06e+00 4.15e+00
1  1 2 2    0.8627 0.388 0.12408   1.05e-01  0.1437     Eff 4.19e-01 1.10e+00 2.87e+00
10 2 3 2    0.8681 0.385 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R      Inf      Inf      Inf
>   print(cc.adj, order.by="haplotype", digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.74, df = 11, p-val = 0.736

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
1  1 2 2    0.8627 0.388 0.12408   1.05e-01  0.1437     Eff 4.19e-01 1.10e+00 2.87e+00
2  1 2 3   -0.6825 0.495 0.05785   6.68e-02  0.0455     Eff 8.55e-02 3.84e-01 1.72e+00
3  1 2 4   -0.6102 0.542 0.04029   4.72e-02  0.0318     Eff 1.66e-01 7.62e-01 3.50e+00
4  1 3 2    0.4168 0.677 0.12842   1.31e-01  0.1286     Eff 2.19e-01 6.65e-01 2.01e+00
5  1 3 3   -0.5312 0.595 0.08029   8.11e-02  0.0763     Eff 2.77e-01 7.95e-01 2.28e+00
6  1 3 4    0.7471 0.455 0.05407   4.82e-02  0.0676     Eff 2.72e-01 1.06e+00 4.15e+00
7  2 2 2    0.0344 0.973 0.13883   1.46e-01  0.1379     Eff 2.04e-01 6.56e-01 2.11e+00
8  2 2 3   -0.1748 0.861 0.09459   8.92e-02  0.1088     Eff 3.59e-01 9.63e-01 2.58e+00
9  2 2 4   -0.8626 0.388 0.02686   3.36e-02  0.0061     Eff 1.04e-06 1.04e-06 1.04e-06
10 2 3 2    0.8681 0.385 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
11 2 3 3   -1.3991 0.162 0.08726   1.06e-01  0.0523     Eff 6.92e-02 3.07e-01 1.36e+00
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R      Inf      Inf      Inf
>   print(cc.adj, order.by="freq", digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.74, df = 11, p-val = 0.736

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
10 2 3 2    0.8681 0.385 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
7  2 2 2    0.0344 0.973 0.13883   1.46e-01  0.1379     Eff 2.04e-01 6.56e-01 2.11e+00
4  1 3 2    0.4168 0.677 0.12842   1.31e-01  0.1286     Eff 2.19e-01 6.65e-01 2.01e+00
1  1 2 2    0.8627 0.388 0.12408   1.05e-01  0.1437     Eff 4.19e-01 1.10e+00 2.87e+00
8  2 2 3   -0.1748 0.861 0.09459   8.92e-02  0.1088     Eff 3.59e-01 9.63e-01 2.58e+00
11 2 3 3   -1.3991 0.162 0.08726   1.06e-01  0.0523     Eff 6.92e-02 3.07e-01 1.36e+00
5  1 3 3   -0.5312 0.595 0.08029   8.11e-02  0.0763     Eff 2.77e-01 7.95e-01 2.28e+00
2  1 2 3   -0.6825 0.495 0.05785   6.68e-02  0.0455     Eff 8.55e-02 3.84e-01 1.72e+00
6  1 3 4    0.7471 0.455 0.05407   4.82e-02  0.0676     Eff 2.72e-01 1.06e+00 4.15e+00
3  1 2 4   -0.6102 0.542 0.04029   4.72e-02  0.0318     Eff 1.66e-01 7.62e-01 3.50e+00
9  2 2 4   -0.8626 0.388 0.02686   3.36e-02  0.0061     Eff 1.04e-06 1.04e-06 1.04e-06
12 2 3 4        NA    NA 0.00628   7.31e-08  0.0195       R      Inf      Inf      Inf
>   summary(cc.adj$fit.lst, digits=3)

Call:
haplo.glm(formula = hglm.formula, family = binomial, data = glm.data, 
    locus.label = locus.label, control = control, miss.val = miss.val)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.3252  -0.9566  -0.7815   1.1967   1.8513  

Coefficients:
                    coef         se     t.stat  pval
(Intercept)    7.357e-01  2.252e+00  3.267e-01 0.744
geno.glm.1     9.263e-02  4.909e-01  1.887e-01 0.851
geno.glm.2    -9.578e-01  7.659e-01 -1.251e+00 0.213
geno.glm.3    -2.713e-01  7.779e-01 -3.488e-01 0.728
geno.glm.4    -4.083e-01  5.655e-01 -7.219e-01 0.471
geno.glm.5    -2.295e-01  5.384e-01 -4.263e-01 0.670
geno.glm.6     6.054e-02  6.956e-01  8.703e-02 0.931
geno.glm.7    -4.223e-01  5.954e-01 -7.092e-01 0.479
geno.glm.8    -3.737e-02  5.035e-01 -7.422e-02 0.941
geno.glm.9    -1.378e+01  3.852e-06 -3.577e+06 0.000
geno.glm.11   -1.181e+00  7.601e-01 -1.554e+00 0.122
geno.glm.rare  4.504e+15  1.398e-13  3.222e+28 0.000
X1            -5.654e-01  3.770e-01 -1.500e+00 0.135
X2            -9.689e-03  4.089e-02 -2.370e-01 0.813

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 265.63  on 199  degrees of freedom
Residual deviance: 238.68  on 186  degrees of freedom
AIC: 260.87

Number of Fisher Scoring iterations: 352


Haplotypes:
              A B C hap.freq
geno.glm.1    1 2 2  0.11705
geno.glm.2    1 2 3  0.05959
geno.glm.3    1 2 4  0.04363
geno.glm.4    1 3 2  0.13125
geno.glm.5    1 3 3  0.07878
geno.glm.6    1 3 4  0.05470
geno.glm.7    2 2 2  0.14512
geno.glm.8    2 2 3  0.09619
geno.glm.9    2 2 4  0.02092
geno.glm.11   2 3 3  0.08544
geno.glm.rare * * *  0.00825
haplo.base    2 3 2  0.15908

>   print.haplo.cc(cc.char.sim, digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 
global-stat = 7.6, df = 11, p-val = 0.749

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                       Counts for Cases and Controls                                                         
-------------------------------------------------------------------------------------------------------------------------------------------- 
control    case 
    124      76 


   A B C Hap-Score p-val pool.hf control.hf case.hf glm.eff OR.lower       OR OR.upper
8  T G G  -1.29121 0.197 0.08726   1.06e-01  0.0523     Eff 7.83e-02 2.84e-01 1.03e+00
10 T T C  -0.95385 0.340 0.02686   3.36e-02  0.0061     Eff 2.17e-03 1.96e-01 1.76e+01
4  A T C  -0.68767 0.492 0.04029   4.72e-02  0.0318     Eff 5.52e-02 4.75e-01 4.09e+00
5  A T G  -0.66560 0.506 0.05785   6.68e-02  0.0455     Eff 1.01e-01 3.53e-01 1.24e+00
2  A G G  -0.47955 0.632 0.08029   8.11e-02  0.0763     Eff 3.27e-01 7.88e-01 1.90e+00
11 T T G  -0.12759 0.898 0.09459   8.92e-02  0.1088     Eff 3.92e-01 9.07e-01 2.10e+00
12 T T T   0.00552 0.996 0.13883   1.46e-01  0.1379     Eff 2.04e-01 5.76e-01 1.63e+00
3  A G T   0.39998 0.689 0.12842   1.31e-01  0.1286     Eff 2.37e-01 6.12e-01 1.58e+00
1  A G C   0.63249 0.527 0.05407   4.82e-02  0.0676     Eff 3.36e-01 1.07e+00 3.43e+00
9  T G T   0.87404 0.382 0.16117   1.46e-01  0.1819    Base       NA 1.00e+00       NA
6  A T T   0.88736 0.375 0.12408   1.05e-01  0.1437     Eff 4.89e-01 1.14e+00 2.68e+00
7  T G C        NA    NA 0.00628   7.31e-08  0.0195       R 1.50e+11 1.50e+11 1.50e+11
>   print(cc.char.sim$fit.lst, digits=3)

Call:  haplo.glm(formula = hglm.formula, family = binomial, data = glm.data, 
    locus.label = locus.label, control = control, miss.val = miss.val)

Coefficients:
  (Intercept)     geno.glm.1     geno.glm.2     geno.glm.3     geno.glm.4     geno.glm.5     geno.glm.6     geno.glm.8    geno.glm.10  
       0.2128         0.0705        -0.2383        -0.4912        -0.7436        -1.0408         0.1350        -1.2576        -1.6317  
  geno.glm.11    geno.glm.12  geno.glm.rare  
      -0.0975        -0.5513        25.7366  

Haplotypes:
              A B C hap.freq
geno.glm.1    A G C  0.05505
geno.glm.2    A G G  0.07852
geno.glm.3    A G T  0.13305
geno.glm.4    A T C  0.04139
geno.glm.5    A T G  0.05978
geno.glm.6    A T T  0.11720
geno.glm.8    T G G  0.08456
geno.glm.10   T T C  0.02469
geno.glm.11   T T G  0.09714
geno.glm.12   T T T  0.14230
geno.glm.rare * * *  0.00636
haplo.base    T G T  0.15995

Degrees of Freedom:  199 Total (i.e. Null);  188 Residual

     Null Deviance:  266 
 Residual Deviance:  245 
               AIC:  262 

>   print(cc.char.sim$score.lst, digits=3)
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                        Haplotype Effect Model: add                                                          
-------------------------------------------------------------------------------------------------------------------------------------------- 
-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                          Global Score Statistics                                                            
-------------------------------------------------------------------------------------------------------------------------------------------- 

global-stat = 7.601, df = 11, p-val = 0.749

-------------------------------------------------------------------------------------------------------------------------------------------- 
                                                         Haplotype-specific Scores                                                           
-------------------------------------------------------------------------------------------------------------------------------------------- 

      A B C Hap-Freq Hap-Score p-val
 [1,] T G G 0.087    -1.291    0.197
 [2,] T T C 0.027    -0.954    0.34 
 [3,] A T C 0.04     -0.688    0.492
 [4,] A T G 0.058    -0.666    0.506
 [5,] A G G 0.08     -0.48     0.632
 [6,] T T G 0.095    -0.128    0.898
 [7,] T T T 0.139    0.006     0.996
 [8,] A G T 0.128    0.4       0.689
 [9,] A G C 0.054    0.632     0.527
[10,] T G T 0.161    0.874     0.382
[11,] A T T 0.124    0.887     0.375

> 
> proc.time()
   user  system elapsed 
 50.530   0.495  52.286 
